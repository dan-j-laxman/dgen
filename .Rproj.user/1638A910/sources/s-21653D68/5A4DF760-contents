devtools::document()

row_less_count =  function(..., value, maxmiss_n = 0){
  
  require(tidyverse)
  
  # Variables are combined into a dataframe
  df = (data.frame(...))
  
  # Check that variables in "..." are in the data frame.
  # Needs to be added
  
  # Number of missing in each row is calculated.
  nmissing = rowSums(is.na(df))
  
  # Number of variables is calculated.
  nvars = NCOL(df)
  
  # Check that maxmiss_n is an integer
  # (Check will fail if deviation from integer is less than 1e15)
  intcheck = maxmiss_n%%1 == 0
  
  if(intcheck == FALSE){
    stop("Number of maximum missing values must be an integer")
  }
  
  else{
    
    # Check that value is numeric
    numeric.check = is.numeric(value)
    
    if(numeric.check == FALSE){
      stop("Value must be numeric. Note: numeric values should not be placed in parentheses")
    }
    
    else{
      
      # Check for negative number of maximum missing values
      if(maxmiss_n < 0){
        stop("Negative number of maximum missing values is not allowed")
      }
      
      # Check if number of maximum missing values greater than number
      # of variables.
      if(maxmiss_n > nvars){
        stop("Number of maximum missing values exceeds number of variables")
      }
      
      # If maxmiss_n is 0 or a positive integer and maxmiss_n does not exceed
      # the number of variables, then calculates count.
      
      if(maxmiss_n <= nvars & maxmiss_n >= 0){
        
        # Count is calculated only for cases missing data on no more
        # than the maximum number of missing values allowed.
        x = (rowSums(df < value, na.rm = TRUE))
        x = ifelse(nmissing > maxmiss_n, NA, x)
      }
      
    }
    
  }
  
  final = x
  
}